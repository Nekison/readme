"""Provide test cases for rtdb_sync_pub.redis_command_parser module.

Copyright (c) 2018, Sorbotics LLC.
All rights reserved.
"""

import unittest

from rtdb_sync_pub import redis_command_parser

EXAMPLE_RESPONSE = b"""1523375435.936375 [2 192.168.1.92:39934] "hmset" "42fb2310-68ba-11e7-bc85-cdd33667276a" "_timestamp" "1522855416993" "data_timestamp" "\"Wed, 04 Apr 2018 11:23:36:993 GMT\"" "ALM_TEST" "0" "CL_RESIDUAL_SCALED" "4.476936" "DISCHARGE_FLOW_SCALED" "0" "FREE_CL_SCALED" "0" "GMM5_AR2_AD" "17.910838" "GMM5_AR2_BOOL" "0" "GMM_W30_AR2_AD" "19.808694" "GMM_W30_AR2_BOOL" "0" "GMM_W30_AR3_AD" "13.304819" "GMM_W30_AR3_BOOL" "0" "GST_LEVEL_SCALED" "0" "HSP_1_ACTUAL_SPEED_SCALED" "0" "HSP_1_CMD_FREQ" "30" "HSP_1_CURRENT" "0" "HSP_1_DC_VOLT" "157" "HSP_1_FAIL" "0" "HSP_1_OUT_FREQ" "0" "HSP_1_RUNNING" "0" "HSP_2_ACTUAL_SPEED_SCALED" "0" "HSP_2_CMD_FREQ" "30" "HSP_2_CURRENT" "0" "HSP_2_DC_VOLT" "153" "HSP_2_FAIL" "0" "HSP_2_OUT_FREQ" "0" "HSP_2_RUNNING" "0" "HSP_3_ACTUAL_SPEED_SCALED" "0" "HSP_3_CMD_FREQ" "30" "HSP_3_CURRENT" "0" "HSP_3_DC_VOLT" "158" "HSP_3_FAIL" "0" "HSP_3_OUT_FREQ" "0" "HSP_3_RUNNING" "0" "HSP_FLOW_SCALED" "0" "TANK1_LEVEL_SCALED" "28" "WELLS_FLOW_SCALED" "0" "WELL_1_2_FLOW_SCALED" "0" "WELL_1_FLOW_SCALED" "0" "WELL_1_WATER_LEVEL_SCALED" "706.299988" "WELL_2_FLOW_SCALED" "0" "WELL_2_WATER_LEVEL_SCALED" "-50" "WELL_3_FLOW_SCALED" "0" "WELL_3_WATER_LEVEL_SCALED" "-50"
1523375435.936644 [2 192.168.1.92:39934] "hmset" "42fb2310-68ba-11e7-bc85-cdd33667276a" "_timestamp" "1522855416993" "data_timestamp" "\"Wed, 04 Apr 2018 11:23:36:993 GMT\"" "ALM_TEST" "0" "CL_RESIDUAL_SCALED" "4.476936" "DISCHARGE_FLOW_SCALED" "0" "FREE_CL_SCALED" "0" "GMM5_AR2_AD" "17.910838" "GMM5_AR2_BOOL" "0" "GMM_W30_AR2_AD" "19.808694" "GMM_W30_AR2_BOOL" "0" "GMM_W30_AR3_AD" "13.304819" "GMM_W30_AR3_BOOL" "0" "GST_LEVEL_SCALED" "0" "HSP_1_ACTUAL_SPEED_SCALED" "0" "HSP_1_CMD_FREQ" "30" "HSP_1_CURRENT" "0" "HSP_1_DC_VOLT" "157" "HSP_1_FAIL" "0" "HSP_1_OUT_FREQ" "0" "HSP_1_RUNNING" "0" "HSP_2_ACTUAL_SPEED_SCALED" "0" "HSP_2_CMD_FREQ" "30" "HSP_2_CURRENT" "0" "HSP_2_DC_VOLT" "153" "HSP_2_FAIL" "0" "HSP_2_OUT_FREQ" "0" "HSP_2_RUNNING" "0" "HSP_3_ACTUAL_SPEED_SCALED" "0" "HSP_3_CMD_FREQ" "30" "HSP_3_CURRENT" "0" "HSP_3_DC_VOLT" "158" "HSP_3_FAIL" "0" "HSP_3_OUT_FREQ" "0" "HSP_3_RUNNING" "0" "HSP_FLOW_SCALED" "0" "TANK1_LEVEL_SCALED" "28" "WELLS_FLOW_SCALED" "0" "WELL_1_2_FLOW_SCALED" "0" "WELL_1_FLOW_SCALED" "0" "WELL_1_WATER_LEVEL_SCALED" "706.299988" "WELL_2_FLOW_SCALED" "0" "WELL_2_WATER_LEVEL_SCALED" "-50" "WELL_3_FLOW_SCALED" "0" "WELL_3_WATER_LEVEL_SCALED" "-50"
1523375436.136855 [0 192.168.1.69:45180] "hmset" "0635ac90-0521-11e7-ae10-4fc19bc13d3a" "STATION9___IBOCON_INDEXINGPUCKSHP" "0" "STATION9___IBOCON_INDEXINGPUCKSWP" "0" "STATION9___IBOCON_PUCKLEAVESTOPMERGE" "0" "STATION9___IBOCON_PUCKLEAVESTOPPER3" "0" "STATION9___IBOCON_PUCKPRESMERGEFEEDING" "0" "STATION9___IBOCON_PUCKPRESMERGERACE" "0" "STATION9___IBOCON_PUCKPRESPRESTOPPER" "0" "STATION9___IBOCON_PUCKPRESSTOPPER1" "0" "STATION9___IBOCON_PUCKPRESSTOPPER2" "0" "STATION9___IBOCON_PUCKPRESSTOPPER3" "0" "STATION9___OBOCON_CYLRELEASEPRESTOP" "0" "STATION9___OBOCON_CYLRELEASESTOP1" "0" "STATION9___OBOCON_CYLRELEASESTOP2" "0" "STATION9___OBOCON_CYLRELEASESTOP3" "0" "STATION9___OBOCON_CYLRELEASESTOPMERGEFEED" "0" "STATION9___OBOCON_CYLRELEASESTOPMERGERACE" "0" "STATION9___OBOCON_ENABLEDRIVEBELT1" "0" "STATION9___OBOCON_ENABLEDRIVEBELT2" "0" "STATION9___OBOCON_INDEXINGPUCKSHP" "0" "STATION9___OBOCON_INDEXINGPUCKSWP" "0" "STATION5___IBOPRI_DRIVEHOMEPOSITION" "0" "STATION5___IBOPRI_LIFTINGEXTRACTIONHOMEPOS" "0" "STATION5___IBOPRI_LIFTINGEXTRACTIONWORKPOS" "0" "STATION5___OBOPRI_CYLINDERLIFTEXTRACTIONHP" "0" "STATION5___OBOPRI_CYLINDERLIFTEXTRACTIONWP" "0" "STATION5___OBOPRI_DISP1EXTRACTION" "0" "STATION5___OBOPRI_DISP2EXTRACTION" "0" "STATION5___OBOPRI_DISP3EXTRACTION" "0" "STATION3___IBOPDT_CLAMPING1HOMEPOS" "0" "STATION3___IBOPDT_CLAMPING1WORKPOS" "0" "STATION3___IBOPDT_CLAMPING2HOMEPOS" "0" "STATION3___IBOPDT_CLAMPING2WORKPOS" "0" "STATION3___IBOPDT_CLAMPING3HOMEPOS" "0" "STATION3___IBOPDT_CLAMPING3WORKPOS" "0" "STATION3___IBOPDT_INSERTIONHOMEPOS" "0" "STATION3___IBOPDT_INSERTIONWORKPOS" "0" "STATION3___IBOPDT_MOVEDOWNHOMEPOS" "0" "STATION3___IBOPDT_MOVEDOWNWORKPOS" "0" "STATION3___IDIPDT_DISP1PRESSURESENSOR" "0" "STATION3___IDIPDT_DISP2PRESSURESENSOR" "0" "STATION3___IDIPDT_DISP3PRESSURESENSOR" "0" "STATION3___OBOPDT_CYLCLAMPING1" "0" "STATION3___OBOPDT_CYLCLAMPING2" "0" "STATION3___OBOPDT_CYLCLAMPING3" "0" "STATION3___OBOPDT_CYLINSERTION" "0" "STATION3___OBOPDT_CYLMOVEDOWNHP" "0" "STATION3___OBOPDT_CYLMOVEDOWNWP" "0" "STATION8___IBOOAR_CLIP1_ID_HOMEPOS" "0" "STATION8___IBOOAR_CLIP1_ID_WORKPOS" "0" "STATION8___IBOOAR_CLIP2_ID_HOMEPOS" "0" "STATION8___IBOOAR_CLIP2_ID_WORKPOS" "0" "STATION8___IBOOAR_CLIP3_ID_HOMEPOS" "0" "STATION8___IBOOAR_CLIP3_ID_WORKPOS" "0" "STATION8___IBOOAR_CLIPDISP1HOMEPOS" "0" "STATION8___IBOOAR_CLIPDISP1WORKPOS" "0" "STATION8___IBOOAR_CLIPDISP2HOMEPOS" "0" "STATION8___IBOOAR_CLIPDISP2WORKPOS" "0" "STATION8___IBOOAR_CLIPDISP3HOMEPOS" "0" "STATION8___IBOOAR_CLIPDISP3WORKPOS" "0" "STATION8___IBOOAR_DMREJECTBOXPRESENT" "0" "STATION8___IBOOAR_DM_EJECTCONTROL" "0" "STATION8___IBOOAR_GOODPARTEJECTCONTROL" "0" "STATION8___IBOOAR_OUTPUTBOXPRESENT" "0" "STATION8___IBOOAR_PDTREJECTBOXPRESENT" "0" "STATION8___IBOOAR_PDT_EJECTCONTROL" "0" "STATION8___IBOOAR_REMOVEDISPFROMIDHP" "0" "STATION8___IBOOAR_REMOVEDISPFROMIDWP" "0" "STATION8___IBOOAR_UNLOADREJDMHOMEPOS" "0" "STATION8___IBOOAR_UNLOADREJDMWORKPOS" "0" "STATION8___IBOOAR_UNLOADREJPDTHOMEPOS" "0" "STATION8___IBOOAR_UNLOADREJPDTWORKPOS" "0" "STATION8___OBOOAR_CYLCLIP1_ID" "0" "STATION8___OBOOAR_CYLCLIP2_ID" "0" "STATION8___OBOOAR_CYLCLIP3_ID" "0" "STATION8___OBOOAR_CYLCLIPDISP1" "0" "STATION8___OBOOAR_CYLCLIPDISP2" "0" "STATION8___OBOOAR_CYLCLIPDISP3" "0" "STATION8___OBOOAR_CYLREMOVEFROMIDHP" "0" "STATION8___OBOOAR_CYLREMOVEFROMIDWP" "0" "STATION8___OBOOAR_CYLUNLOADREJDMHP" "0" "STATION8___OBOOAR_CYLUNLOADREJDMWP" "0" "STATION8___OBOOAR_CYLUNLOADREJPDTHP" "0" "STATION8___OBOOAR_CYLUNLOADREJPDTWP" "0" "STATION2___IBOFEE_CLIP1INDEXDIALHOMEPOS" "0" "STATION2___IBOFEE_CLIP1INDEXDIALWORKPOS" "0" "STATION2___IBOFEE_CLIP2INDEXDIALHOMEPOS" "0" "STATION2___IBOFEE_CLIP2INDEXDIALWORKPOS" "0" "STATION2___IBOFEE_CLIP3INDEXDIALHOMEPOS" "0" "STATION2___IBOFEE_CLIP3INDEXDIALWORKPOS" "0" "STATION2___IBOFEE_CLIPDISP1HOMEPOS" "0" "STATION2___IBOFEE_CLIPDISP1WORKPOS" "0" "STATION2___IBOFEE_CLIPDISP2HOMEPOS" "0" "STATION2___IBOFEE_CLIPDISP2WORKPOS" "0" "STATION2___IBOFEE_CLIPDISP3HOMEPOS" "0" "STATION2___IBOFEE_CLIPDISP3WORKPOS" "0" "STATION2___IBOFEE_DISP1BENTLEFTEYE" "0" "STATION2___IBOFEE_DISP1BENTRIGHTEYE" "0" "STATION2___IBOFEE_DISP1PRESENCECHECK" "0" "STATION2___IBOFEE_DISP2BENTLEFTEYE" "0" "STATION2___IBOFEE_DISP2BENTRIGHTEYE" "0" "STATION2___IBOFEE_DISP2PRESENCECHECK" "0" "STATION2___IBOFEE_DISP3BENTLEFTEYE" "0" "STATION2___IBOFEE_DISP3BENTRIGHTEYE" "0" "STATION2___IBOFEE_DISP3PRESENCECHECK" "0" "STATION2___IBOFEE_DISPLIFTINGHOMEPOS" "0" "STATION2___IBOFEE_DISPLIFTINGWORKPOS" "0" "STATION2___IBOFEE_INSERTIONPUCKHOMEPOS" "0" "STATION2___IBOFEE_INSERTIONPUCKWORKPOS" "0" "STATION2___IBOFEE_ROTATIONPOSCONVEYOR" "0" "STATION2___IBOFEE_ROTATIONPOSID" "0" "STATION2___OBOFEE_CYLCLIP1INDEXDIAL" "0" "STATION2___OBOFEE_CYLCLIP2INDEXDIAL" "0" "STATION2___OBOFEE_CYLCLIP3INDEXDIAL" "0" "STATION2___OBOFEE_CYLCLIPDISP1" "0" "STATION2___OBOFEE_CYLCLIPDISP2" "0" "STATION2___OBOFEE_CYLCLIPDISP3" "0" "STATION2___OBOFEE_CYLDISPLIFTINGHP" "0" "STATION2___OBOFEE_CYLDISPLIFTINGWP" "0" "STATION2___OBOFEE_CYLINSERTIONHP" "0" "STATION2___OBOFEE_CYLINSERTIONWP" "0" "STATION2___OBOFEE_CYLROTATIONCON" "0" "STATION2___OBOFEE_CYLROTATIONID" "0" "STATION4___IBOPRE_PREFILLHOMEPOS" "0" "STATION4___IBOPRE_PREFILLWORKPOS" "0" "STATION4___IBOPRE_PROCLINELEVELMIN" "0" "STATION4___OBOPRE_CYLLIFTPREFILLHP" "0" "STATION4___OBOPRE_CYLLIFTPREFILLWP" "0" "STATION4___OBOPRE_ENDRIVEPREFILLPUMP1" "0" "STATION4___OBOPRE_ENDRIVEPREFILLPUMP2" "0" "STATION4___OBOPRE_ENDRIVEPREFILLPUMP3" "0" "STATION1___IBOID_ALARMSUMMARY" "0" "STATION1___IBOID_DRIVEINPOSITION" "0" "STATION1___IBOID_DRIVETIMEOUT" "0" "STATION1___IBOID_HOMEPOSSENSOR" "0" "STATION1___IBOID_POSITIONOVERRUN" "0" "STATION1___IBOID_STARTALLOWED" "0" "STATION1___IBOID_STATEAUTOMATIK" "0" "STATION1___OBOID_ADDSTOP" "0" "STATION1___OBOID_BRAKERELEASE" "0" "STATION1___OBOID_ENABLE" "0" "STATION1___OBOID_STARTDRIVEEDGE" "0" "STATION6___IBODM_DRIVEHOMEPOS" "0" "STATION6___IBODM_EXTRACTIONHOMEPOS" "0" "STATION6___IBODM_EXTRACTIONWORKPOS" "0" "STATION6___IBODM_SCALESYSINPLACE" "0" "STATION6___OBODM_CYLINDEREXTRACTIONHP" "0" "STATION6___OBODM_CYLINDEREXTRACTIONWP" "0" "STATION6___OBODM_WATERBASIN1EXTRACTION" "0" "STATION6___OBODM_WATERBASIN2EXTRACTION" "0" "STATION6___OBODM_WATERBASIN3EXTRACTION" "0" "STATION0_PM___ANOMALY_DET_ANALOG" "0" "STATION0_PM___ANOMALY_DET_SCORE" "0" "STATION7___IBOEVA_DISPMIDPOSHOMEPOS" "0" "STATION7___IBOEVA_DISPMIDPOSWORKPOS" "0" "STATION7___IBOEVA_LIFTINGEVAHOMEPOS" "0" "STATION7___IBOEVA_LIFTINGEVAWORKPOS" "0" "STATION7___IBOEVA_WATERFLOWDETECTION1" "0" "STATION7___IBOEVA_WATERFLOWDETECTION2" "0" "STATION7___IBOEVA_WATERFLOWDETECTION3" "0" "STATION7___OBOEVA_CYLDISPMIDPOSHP" "0" "STATION7___OBOEVA_CYLDISPMIDPOSWP" "0" "STATION7___OBOEVA_CYLLIFTINGEVACUATIONHP" "0" "STATION7___OBOEVA_CYLLIFTINGEVACUATIONWP" "0" "STATION7___OBOEVA_DISP1EVACUATING" "0" "STATION7___OBOEVA_DISP2EVACUATING" "0" "STATION7___OBOEVA_DISP3EVACUATING" "0" "STATION0___IBOMAG_2NDTANKMIN" "0" "STATION0___IBOMAG_2NDTANKPRESSAVAILABLE" "0" "STATION0___IBOMAG_2NDTANKVACAVAILABLE" "0" "STATION0___IBOMAG_CIRCUITBREAKERNOTRELEASED" "0" "STATION0___IBOMAG_CTRLONRELAYDROPEDOUT" "0" "STATION0___IBOMAG_E_STOPRELAYDROPEDOUT" "0" "STATION0___IBOMAG_FEEDBACKMAINPRESSVALVE" "0" "STATION0___IBOMAG_MAINPRESSUREAVAILABLE" "0" "STATION0___IBOMAG_MAINTANKMAX" "0" "STATION0___IBOMAG_MAINTANKMIN" "0" "STATION0___IBOMAG_MAINTANKVACAVAILABLE" "0" "STATION0___IBOMAG_NOOVERTEMPCCC" "0" "STATION0___IBOMAG_NOOVERTEMPPCC" "0" "STATION0___IBOMAG_NOOVERTEMPVEC" "0" "STATION0___IBOMAG_OPERATINGPRESSUREAVAILABLE" "0" "STATION0___IBOMAG_SAFETYDOOROPEN0" "0" "STATION0___IBOMAG_VACUUMAVAILABLE" "0" "STATION0___OBOMAG_ENABLECONTROLONPLC" "0" "STATION0___OBOMAG_ENDRIVEVACUUMEXHAUSTER" "0" "STATION0___OBOMAG_LAMPCONTROLOFF" "0" "STATION0___OBOMAG_LAMPCONTROLON" "0" "STATION0___OBOMAG_LIGHTTOWERGREEN" "0" "STATION0___OBOMAG_LIGHTTOWERRED" "0" "STATION0___OBOMAG_LIGHTTOWERYELLOW" "0" "STATION0___OBOMAG_LOCKSAFETYDOORS" "0" "STATION0___OBOMAG_NOERRORPLC" "0" "STATION0___OBOMAG_OPERATINGHOURSCOUNTER" "0" "STATION0___OBOMAG_RESETE_STOPRELAY" "0" "STATION0___OBOMAG_RESETMAINPRESSUREVALVE" "0" "_timestamp" "1523375456740" "data_timestamp" "\"Tue, 10 Apr 2018 15:50:56 GMT\""""


class TestParseResponse(unittest.TestCase):
    """parse_response function test case."""

    def test_raise_exception_inv_number_args(self):
        try:
            redis_command_parser.parse_response(b"OK")
        except Exception as e:
            self.assertEqual(e.args[0], "Invalid number of arguments")

    def test_return_dict(self):
        command = redis_command_parser.parse_response(EXAMPLE_RESPONSE)

        self.assertTrue(isinstance(command, dict))


if __name__ == '__main__':
    unittest.main()
